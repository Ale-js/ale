/*! Ale.js JavaScript Framework
 * Version: 1.0.0
 * (c) 2018 Dong Yingxuan (Bill Dong)
 * Released under the MIT License
 */
(function(D,h){var H="1.0.0",E=0,t=[],C=[],G=[],b=[],z=[],l=0,o=false,j=null,a={html:false,diff:true,async:true,configLock:false};D.Ale=function(M,L){if(typeof M!=="string"||!v(L)){if(!v(M)){throw"Ale.js: Wrong type of parameters was used when creating component objects!"}else{return new w(u(M))}}if(t[M]!==undefined){throw"Ale.js: This component has been created!"}t[M]=u(L)};Ale.render=function(M,L){var N=r(t[M]);return J(N,L)};Ale.config=function(M,N){if(a["configLock"]){throw"Ale.js: The configuration function is locked, no changes are allowed!"}if(v(M)){for(var L in M){a[L]=M[L]}}else{if(typeof M==="string"&&N!==undefined){a[M]=N}else{throw"Ale.js: The parameter type is wrong when calling the config function!"}}};Ale.isHasThisComponent=function(L){if(t[L]===undefined){return false}return true};Ale.use=function(L){if(typeof L.name!=="string"||typeof L.install!=="function"){throw"Ale.js: Some fields were not added when the plugin was registered!"}if(C[L.name]!==undefined){throw"Ale.js: This plugin has been registered!"}C[L.name]=L.name;L.install()};Ale.filter=function(L){if(typeof L!=="function"&&!Array.isArray(L)){throw"Ale.js: You need to pass in a function or array when adding a filter!"}if(typeof L==="function"){G.push(L)}else{if(Array.isArray(L)){G=G.concat(L)}}};Ale.nextTick=function(L){if(typeof L==="function"){j=L}else{throw"Ale.js: You need to pass in a function when adding a tick callback function!"}};Ale.plugin={};Ale.plugin.inject=function(L){if(typeof L!=="function"){throw"Ale: The wrong data type for plug-in injection!"}b.push(L)};Ale.version=H;function w(L){this.config=L;this.render=function(M){return J(r(this.config),M)}}function s(O,N){if(typeof N!=="undefined"){if(typeof N==="function"){if(!(O instanceof N)){throw"Ale.js: Incorrect component data type!"}}else{if(Array.isArray(N)){var M=false;for(var L=0;L<N.length;L++){if(typeof N[L]==="function"){if(O instanceof N[L]){M=true;break}}else{if(typeof O===N[L]){M=true;break}}}if(!M){throw"Ale.js: Incorrect component data type!"}}else{if(typeof O!==N){throw"Ale.js: Incorrect component data type!"}}}}}function F(O,L){this.id="i"+E++;this.el=O;this.nodeList=h.querySelectorAll(this.el);this.config=L;this.template=L.template;this.data=L.data;this.staticData=L.staticData;this.dataType=L.dataType;this.methods=v(L.methods)?L.methods:{};this.life=L.life;this.type=L.type;this.imports=L.imports;this.proxy=v(L.proxy)?L.proxy:{};this.watch=v(L.watch)?L.watch:{};this.name=typeof L.name==="string"?L.name:"unknow";if(!v(this.dataType.data)){this.dataType.data={}}if(!v(this.dataType.staticData)){this.dataType.staticData={}}for(var M in this.data){s(this.data[M],this.dataType.data[M]);this.data[M]=B(this.data[M])}for(var M in this.staticData){s(this.staticData[M],this.dataType.staticData[M]);this.staticData[M]=B(this.staticData[M])}this.life=c(this.life,this);this.methods=A(this.methods,this);this.proxy=x(this.proxy,this);var N=typeof this.data==="function"?this.data():r(this.data);this.data=typeof this.data==="function"?this.data():this.data;var P=typeof this.staticData==="function"?this.staticData():r(this.staticData);this.staticData=typeof this.staticData==="function"?this.staticData():this.staticData;d(this,this.data,this.methods,{id:this.id,type:this.type,nodeList:this.nodeList,template:this.template,imports:this.imports,life:this.life,staticData:this.staticData,watch:this.watch});if(typeof this.life.mounting==="function"){this.life.mounting()}(function(S,T,U,R,Q){Object.defineProperty(S,"staticData",{set:function(X){if(typeof T.staticDataUpdating==="function"){T.staticDataUpdating()}var W=m("static",R.setter,S,X);X=W.val;for(var V in X){s(X[V],Q.staticData[V]);P[V]=B(X[V])}},get:function(){return m("static",R.getter,S,U).val}})})(this,this.life,this.staticData,this.proxy,this.dataType);for(var M in this.staticData){(function(S,T,U,R,Q){Object.defineProperty(U,S,{set:function(W){s(W,Q.staticData[S]);if(typeof T.staticDataUpdating==="function"){T.staticDataUpdating()}var V=m("static",R.setter,S,W);W=V.val;P[S]=B(W)},get:function(){return m("static",R.getter,S,P[S]).val}})})(M,this.life,this.staticData,this.proxy,this.dataType)}(function(W,R,V,T,ac,U,ab,Z,Q,Y,S,aa,X){Object.defineProperty(W,"data",{set:function(af){var ae=m("normal",Y.setter,W,af);af=ae.val;for(var ad in af){s(af[ad],aa.data[ad]);N[ad]=B(af[ad])}if(ae.needBreak){return}if(typeof ab.updating==="function"){ab.updating()}n(V,T,{id:R,type:Z,nodeList:U,newData:N,template:ac,imports:Q,life:ab,staticData:S})},get:function(){return m("normal",Y.getter,W,V).val}})})(this,this.id,this.data,this.methods,this.template,this.nodeList,this.life,this.type,this.imports,this.proxy,this.staticData,this.dataType,this.watch);for(var M in this.data){(function(X,S,R,W,U,ac,V,ab,Z,Q,Y,T,aa){Object.defineProperty(W,X,{set:function(ae){s(ae,aa.data[X]);var ad=m("normal",Y.setter,X,ae);ae=ad.val;
N[X]=B(ae);if(ad.needBreak){return}if(typeof ab.updating==="function"){ab.updating()}n(W,U,{id:R,type:Z,nodeList:V,newData:N,template:ac,imports:Q,life:ab,staticData:T})},get:function(){return m("normal",Y.getter,X,N[X]).val}})})(M,this,this.id,this.data,this.methods,this.template,this.nodeList,this.life,this.type,this.imports,this.proxy,this.staticData,this.dataType)}}F.prototype.destroy=function(){for(var L in this.data){(function(N,O){Object.defineProperty(O,N,{set:function(){},get:function(){return undefined}})})(L,this.data)}for(var L=0;L<this.nodeList.length;L++){this.nodeList[L].innerHTML=""}if(typeof this.life.unmounting==="function"){this.life.unmounting()}var M=this.life.destroy;for(var L in this){delete this[L]}if(typeof M==="function"){M()}};function J(N,L){if(N===undefined){throw"Ale.js: This component has not been created yet!"}if(typeof L.el!=="string"){throw"Ale.js: The type of the el should be a string!"}if(typeof N.life.using==="function"){N.life.using()}if(v(L.proxy)){N.proxy=L.proxy}N.data=typeof N.data==="function"?N.data():N.data;if(!v(N.data)){N.data={}}for(var M in L.data){N.data[M]=L.data[M]}N.staticData=typeof N.staticData==="function"?N.staticData():N.staticData;if(!v(N.staticData)){N.staticData={}}for(var M in L.staticData){N.staticData[M]=L.staticData[M]}for(var M in L.methods){N.methods[M]=L.methods[M]}return new F(L.el,N)}function u(O){if(O.template===undefined){throw"Ale.js: No template is added when creating a component object!"}O.life=v(O.life)?O.life:{};O.dataType=v(O.dataType)?O.dataType:{};if(!Array.isArray(O.imports)){O.type=1}else{O.type=2;O.template=[O.template];var X,V,N,Y={},P={},Q={},W={},M={},L={},S={},R=[];for(var T=0;T<O.imports.length;T++){if(typeof O.imports[T]==="string"){X=t[O.imports[T]]}else{if(typeof O.imports[T]==="object"){X=O.imports[T].config}}if(X===undefined){throw"Ale.js: The imported component is not created!"}if(X.type===1){O.template.push(X.template)}else{O.template=O.template.concat(X.template);R=R.concat(X.imports)}V=typeof X.data==="function"?X.data():X.data;N=typeof X.staticData==="function"?X.staticData():X.staticData;if(v(V)){for(var U in V){Y[U]=V[U]}}if(v(X.methods)){for(var U in X.methods){P[U]=X.methods[U]}}if(v(X.life)){for(var U in X.life){Q[U]=X.life[U]}}if(v(X.proxy)){for(var U in X.proxy){W[U]=X.proxy[U]}}if(v(X.dataType.data)){for(var U in X.dataType.data){L[U]=X.dataType.data[U]}}if(v(X.dataType.staticData)){for(var U in X.dataType.staticData){S[U]=X.dataType.staticData[U]}}if(v(N)){for(var U in N){M[U]=N[U]}}}O.imports=O.imports.concat(R);O.data=typeof O.data==="function"?O.data():O.data;O.staticData=typeof O.staticData==="function"?O.staticData():O.staticData;if(v(O.data)){for(var T in O.data){Y[T]=O.data[T]}}if(v(O.methods)){for(var T in O.methods){P[T]=O.methods[T]}}if(v(O.life)){for(var T in O.life){Q[T]=O.life[T]}}if(v(O.proxy)){for(var T in O.proxy){W[T]=O.proxy[T]}}if(v(O.dataType.data)){for(var T in O.dataType.data){L[T]=O.dataType.data[T]}}if(v(O.dataType.staticData)){for(var T in O.dataType.staticData){S[T]=O.dataType.staticData[T]}}if(v(O.staticData)){for(var T in O.staticData){M[T]=O.staticData[T]}}O.data=Y;O.methods=P;O.life=Q;O.proxy=W;O.dataType.data=L;O.dataType.staticData=S;O.staticData=M}return O}function m(P,L,O,S){if(typeof L==="function"){var R=false;function Q(){R=true}var M={type:P,key:O,val:S,preventUpdating:Q},N=L(M);return{val:N,needBreak:R}}return{val:S,needBreak:false}}function f(L){return/native code/.test(L.toString())&&typeof L!=="undefined"}function y(L){for(var N in L){for(var M=0;M<L[N].nodeList.length;M++){if(L[N].diff){g(L[N].renderingResultObj.newEl.childNodes,L[N].nodeList[M].childNodes,L[N].nodeList[M],L[N].renderingResultObj.newTem)}else{L[N].nodeList[M].innerHTML=L[N].renderingResultObj.newTem}k(L[N].nodeList[M],L[N].data,L[N].methods)}}}function K(){if(typeof j==="function"){var L=j;j=null;L()}if(l===0){o=false}else{I(z);z=[];l=0}}function I(L){o=true;(function(M){if(typeof Promise!=="undefined"&&f(Promise)){new Promise(function(O,N){O()}).then(function(){y(M);K()})}else{setTimeout(function(){y(M);K()},0)}})(L)}function q(N,M,O){if(a.async){O.data=N;O.methods=M;z[O.id.toString()]=O;l++;if(!o){I(z);z=[];l=0}}else{for(var L=0;L<O.nodeList.length;L++){if(O.diff){g(O.renderingResultObj.newEl.childNodes,O.nodeList[L].childNodes,O.nodeList[L],O.renderingResultObj.newTem)}else{O.nodeList[L].innerHTML=O.renderingResultObj.newTem}k(O.nodeList[L],N,M)}}}function e(P){var M={data:P.data,methods:P.methods,staticData:P.staticData};if(P.type===1){var O=typeof P.template==="function"?i(P.template,M)():P.template,Q=h.createElement("div");for(var L=0;L<G.length;L++){O=G[L](O)}Q.innerHTML=O}else{var O=P.template[0],N,Q=h.createElement("div");if(typeof O==="function"){O=i(O,M)()}for(var L=1;L<P.template.length;L++){N=new RegExp("<"+(typeof P.imports[L-1]==="string"?P.imports[L-1]:P.imports[L-1].config.name)+"/>","g");if(typeof P.template[L]==="function"){O=O.replace(N,i(P.template[L],M)())}else{O=O.replace(N,P.template[L])
}}for(var L=0;L<G.length;L++){O=G[L](O)}Q.innerHTML=O}if(typeof P.life.rendering==="function"){P.life.rendering()}return({newEl:Q,newTem:O})}function p(M,N){for(var L=0;L<b.length;L++){b[L](M)}}function d(M,O,L,P){P.data=O;P.methods=L;var N=e(P);q(O,L,{id:P.id,nodeList:P.nodeList,renderingResultObj:N,diff:false});p(M,P.watch)}function n(N,L,O){O.data=O.newData;O.methods=L;var M=e(O);q(N,L,{id:O.id,nodeList:O.nodeList,renderingResultObj:M,newData:O.newData,diff:true})}function g(Q,O,R,P){if(!a.diff){R.innerHTML=P}if(Q.length===0){R.innerHTML="";return}var L=0;for(var N=0;N<Q.length;N++){while(Q[N+1]===undefined&&O[N+1]!==undefined){O[N+1].remove()}if(O[N]===undefined){if(R.nodeName==="#text"){R.nodeValue=Q[N].nodeValue}else{R.appendChild(Q[N].cloneNode(true))}}else{if(Q[N].nodeName==="#text"){if(O[N].nodeName!=="#text"){O[N].parentNode.innerHTML=Q[N].nodeValue}else{if(Q[N].nodeValue!==O[N].nodeValue){O[N].nodeValue=Q[N].nodeValue}}}else{if(O[N].nodeName!=="#text"){if(O[N].tagName!==Q[N].tagName||O[N].getAttribute("id")!==Q[N].getAttribute("id")||O[N].getAttribute("class")!==Q[N].getAttribute("class")||O[N].getAttribute("name")!==Q[N].getAttribute("name")){var M=Q[N].cloneNode(true);R.replaceChild(M,O[N])}}else{R.replaceChild(Q[N],O[N]);continue}if(Q[N].childNodes.length>0){g(Q[N].childNodes,O[N].childNodes,R.childNodes[N])}else{if(O[N].childNodes.length>0){O[N].innerHTML=""}}}}}}function B(L){if(typeof L==="string"&&!a.html){L=L.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}return L}function x(M,N){for(var L in M){M[L]=i(M[L],N)}return M}function A(L,N){for(var M in L){L[M]=i(L[M],N)}return L}function c(N,M){for(var L in N){N[L]=i(N[L],M)}return N}function k(N,O,L){N.data=O;N.methods=L;if(N.children.length>0){for(var M=0;M<N.children.length;M++){k(N.children[M],O,L)}}}function r(N){var L=Array.isArray(N)?[]:{};if(Array.isArray(N)){for(var M=0;M<N.length;M++){if(v(N[M])||Array.isArray(N[M])){L.push(r(N[M]))}else{L.push(N[M])}}}else{for(var M in N){if(v(N[M])||Array.isArray(N[M])){L[M]=r(N[M])}else{L[M]=N[M]}}}return L}function v(O){var N,M,L=function(){return{}};if(!O||L().toString.call(O)!=="[object Object]"){return false}N=Object.getPrototypeOf(O);if(!N){return true}M=L.hasOwnProperty.call(N,"constructor")&&N.constructor;return typeof M==="function"&&L.hasOwnProperty.toString(M)===L.hasOwnProperty.toString(Object)}function i(N,L){function M(P){var O=arguments.length;return O?O>1?N.apply(L,arguments):N.call(L,P):N.call(L)}M._length=N.length;return M}})(window,document);
